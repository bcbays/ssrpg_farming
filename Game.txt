// Imports
var _GameState = import Games/Farming/Enums/GameState

// Variables
var initialized = false
var _state = _GameState.None

var _HUDComponent = null

var _entranceScene = null
var _mainHubScene = null
var _farmScene = null
var _workshopScene = null

// Functions
func Init()
  ?this.initialized
    return
  
  // Components
  this._HUDComponent = import Games/Farming/Components/HUD
  this._HUDComponent.Init()

  // Scenes
  this._entranceScene = import Games/Farming/Scenes/Entrance
  this._entranceScene.Init()
  this._mainHubScene = import Games/Farming/Scenes/MainHub
  this._mainHubScene.Init()
  this._farmScene = import Games/Farming/Scenes/Farm
  this._farmScene.Init()
  this._workshopScene = import Games/Farming/Scenes/Workshop
  this._workshopScene.Init()

  // Disable HUD Elements
  disable abilities
  disable banner
  disable hud
  disable loadout input
  disable loadout print
  disable player
  
  this._HUDComponent.DrawOnTop()

  // State
  this._state = _GameState.Entrance
  this.initialized = true

func SetState(state)
  this._OnStateChangeFrom(this._state)
  this._OnStateChangeTo(state)
  this._state = state

func _OnStateChangeFrom(state)
  ?state = _GameState.Entrance
    this._entranceScene.OnStateChangeFrom()
  :?state = _GameState.MainHub
    this._mainHubScene.OnStateChangeFrom()
  :?state = _GameState.Farm
    this._farmScene.OnStateChangeFrom()
  :?state = _GameState.Workshop
    this._workshopScene.OnStateChangeFrom()

func _OnStateChangeTo(state)
  ?state = _GameState.Entrance
    this._entranceScene.OnStateChangeTo()
  :?state = _GameState.MainHub
    this._mainHubScene.OnStateChangeTo()
  :?state = _GameState.Farm
    this._farmScene.OnStateChangeTo()
  :?state = _GameState.Workshop
    this._workshopScene.OnStateChangeTo()

func Update()
  ?_state = _GameState.None
    // TODO: Make this panic or something
    >#red,GameState.None
    loc.Pause()
  :?_state = _GameState.Entrance
    this._entranceScene.Update()
    this._entranceScene.Draw()
  :?_state = _GameState.MainHub
    this._mainHubScene.Update()
    this._mainHubScene.Draw()
    this._HUDComponent.Update()
  :?_state = _GameState.Farm
    this._farmScene.Update()
    this._farmScene.Draw()
    this._HUDComponent.Update()
  :?_state = _GameState.Workshop
    this._workshopScene.Update()
    this._workshopScene.Draw()
    this._HUDComponent.Update()